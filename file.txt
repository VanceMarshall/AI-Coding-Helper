# filepath: Dockerfile
FROM node:18-alpine

WORKDIR /app

COPY package*.json ./
RUN npm install

COPY . .

# Create a non-root user
RUN addgroup -g 1001 nodejs && \
    adduser -u 1001 -G nodejs -s /bin/sh -D nodejs

# Set ownership of the data directory
RUN chown -R nodejs:nodejs data

# Switch to the non-root user
USER nodejs

EXPOSE 8080

ENV PORT=8080

CMD ["node", "server.js"]
